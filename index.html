<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>First 100 Alaners</title>
    <!-- React -->
    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <!-- PapaParse for CSV processing -->
    <script src="https://unpkg.com/papaparse@5.3.0/papaparse.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f9fafb;
        }
        #root {
            margin: 0 auto;
            max-width: 800px;
            padding: 20px;
        }
        .container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        h1, h2 {
            color: #333;
        }
        button {
            background-color: #4285f4;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-bottom: 10px;
        }
        .timer {
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            padding: 10px;
            background-color: #f0f9ff;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        .timer.ending {
            color: #b91c1c;
            background-color: #fee2e2;
        }
        .message {
            margin: 16px 0;
            padding: 12px;
            border-radius: 4px;
        }
        .error {
            background-color: #fee2e2;
            color: #b91c1c;
        }
        .success {
            background-color: #dcfce7;
            color: #166534;
        }
        .hint-button {
            background-color: #f59e0b;
            margin-right: 5px;
        }
        .hint-button.active {
            background-color: #d97706;
        }
        .employee-list {
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            overflow: hidden;
        }
        .employee-list-header {
            background-color: #1f2937;
            color: white;
            padding: 10px 15px;
            font-weight: bold;
        }
        .employee-table {
            width: 100%;
            border-collapse: collapse;
        }
        .employee-table th, .employee-table td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        .employee-table th {
            background-color: #f3f4f6;
        }
        .employee-table tr:nth-child(even) {
            background-color: #f9fafb;
        }
        .hidden-name {
            color: #9ca3af;
        }
        .sticky-search {
            position: sticky;
            top: 0;
            background-color: white;
            padding: 10px 0;
            z-index: 10;
        }
        .login-container {
            max-width: 400px;
            margin: 50px auto;
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .leaderboard-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        .leaderboard-table th, .leaderboard-table td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        .leaderboard-table th {
            background-color: #f3f4f6;
        }
        .highlight-row {
            background-color: #ecfdf5;
        }
        .start-button {
            background-color: #22c55e;
            color: white;
            padding: 12px 20px;
            border-radius: 4px;
            border: none;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
        }
        .finish-button {
            background-color: #ef4444;
            color: white;
            padding: 10px 20px;
            font-weight: bold;
            margin-top: 10px;
        }
        .actions-container {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <script>
        // Firebase initialization
        const firebaseConfig = {
            apiKey: "AIzaSyCrvRv5dxD4bwlVoMsX2BnKTzp58UdOg2g",
            authDomain: "first-100-alaners.firebaseapp.com",
            projectId: "first-100-alaners",
            storageBucket: "first-100-alaners.firebasestorage.app",
            messagingSenderId: "996377669747",
            appId: "1:996377669747:web:d27ab25e99d6c58278fa06",
            measurementId: "G-73746XWZ6C"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Complete employee data

        // Main application
        function App() {
            const { useState, useEffect, useRef } = React;
            
            // States for login screen
            const [playerEmail, setPlayerEmail] = useState("");
            const [isPlaying, setIsPlaying] = useState(false);
            const [leaderboard, setLeaderboard] = useState([]);
            const [isLoadingLeaderboard, setIsLoadingLeaderboard] = useState(true);
            const [loginMessage, setLoginMessage] = useState("");
            const [isLoginError, setIsLoginError] = useState(false);
            
            // Game states
            const [employes, setEmployes] = useState([]);
            const [employesCharges, setEmployesCharges] = useState(false);
            const [recherche, setRecherche] = useState("");
            const [message, setMessage] = useState("");
            const [isError, setIsError] = useState(false);
            const [stats, setStats] = useState({ total: 0, decouverts: 0, score: 0 });
            const [indicesActives, setIndicesActives] = useState({
                communaute: false,
                role: false,
                initiales: false
            });
            const [seuilSimilarite, setSeuilSimilarite] = useState(0.8);
            const [jeuCommence, setJeuCommence] = useState(false);
            const [tempsRestant, setTempsRestant] = useState(1200); // 20 minutes in seconds
            const [jeuTermine, setJeuTermine] = useState(false);
            const timerRef = useRef(null);
            const scrollPositionRef = useRef(0);

            // Load leaderboard on startup
            useEffect(() => {
                loadLeaderboard();
            }, []);

            // Load leaderboard
            function loadLeaderboard() {
                setIsLoadingLeaderboard(true);
                db.collection("scores")
                    .orderBy("score", "desc")
                    .limit(10)
                    .get()
                    .then((snapshot) => {
                        const scores = [];
                        snapshot.forEach((doc) => {
                            scores.push({
                                id: doc.id,
                                ...doc.data()
                            });
                        });
                        setLeaderboard(scores);
                        setIsLoadingLeaderboard(false);
                    })
                    .catch((error) => {
                        console.error("Error loading leaderboard:", error);
                        setIsLoadingLeaderboard(false);
                    });
            }

            // Function to save score and redirect to leaderboard
            function saveScore(forceScore = null, forceDiscovered = null) {
                if (!playerEmail) return;
                
                // Use forced values or current state values
                const scoreToSave = forceScore !== null ? forceScore : stats.score;
                const discoveredToSave = forceDiscovered !== null ? forceDiscovered : stats.decouverts;
                
                try {
                    // Check if player already has a score
                    db.collection("scores")
                        .where("email", "==", playerEmail)
                        .get()
                        .then((snapshot) => {
                            if (snapshot.empty) {
                                // Create a new score
                                return db.collection("scores").add({
                                    email: playerEmail,
                                    score: scoreToSave,
                                    discovered: discoveredToSave,
                                    total: stats.total,
                                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                                });
                            } else {
                                // Update existing score if new score is higher
                                const doc = snapshot.docs[0];
                                const currentScore = doc.data().score;
                                if (scoreToSave > currentScore) {
                                    return db.collection("scores").doc(doc.id).update({
                                        score: scoreToSave,
                                        discovered: discoveredToSave,
                                        timestamp: firebase.firestore.FieldValue.serverTimestamp()
                                    });
                                } else {
                                    return Promise.resolve();
                                }
                            }
                        })
                        .then(() => {
                            loadLeaderboard();
                            setMessage("Your score has been saved!");
                            setIsError(false);
                            
                            // Redirect to leaderboard view
                            setIsPlaying(false);
                            setJeuCommence(false);
                            setJeuTermine(false);
                            setEmployesCharges(false);
                        })
                        .catch((error) => {
                            console.error("Error saving score:", error);
                            setMessage("Error saving your score. Please try again.");
                            setIsError(true);
                        });
                } catch (error) {
                    console.error("Error saving score:", error);
                    setMessage("Error saving your score. Please try again.");
                    setIsError(true);
                }
            }

            // Finish game and save score
            function finishGame() {
                if (!jeuCommence || jeuTermine) return;
                
                // Confirm before finishing
                if (window.confirm("Are you sure you want to finish the game and submit your score?")) {
                    // Clear timer
                    if (timerRef.current) {
                        clearInterval(timerRef.current);
                    }
                    
                    // Set game as finished
                    setJeuTermine(true);
                    
                    // Reveal all answers
                    setEmployes(function(prevEmployes) {
                        return prevEmployes.map(function(employe) {
                            return { ...employe, decouvert: true };
                        });
                    });
                    
                    // Save score and redirect to leaderboard
                    saveScore();
                }
            }

            // Load employee data
            useEffect(() => {
                if (isPlaying && !employesCharges) {
                    Papa.parse(donneesBrutes, {
                        header: true,
                        skipEmptyLines: true,
                        complete: function(results) {
                            // Transform data
                            const donnees = results.data.map(function(employe) {
                                return {
                                    id: employe.employee_id,
                                    prenom: employe.first_name,
                                    nom: employe.last_name,
                                    dateDebut: employe.original_start_date,
                                    communaute: employe.community,
                                    role: employe.role,
                                    initialePrenom: employe.first_initial,
                                    initialeNom: employe.last_initial,
                                    longueurNom: employe.last_name.length,
                                    decouvert: false
                                };
                            });
                            
                            // Sort employees by ID
                            donnees.sort(function(a, b) {
                                return parseInt(a.id) - parseInt(b.id);
                            });
                            
                            setEmployes(donnees);
                            setStats({ total: donnees.length, decouverts: 0, score: 0 });
                            setEmployesCharges(true);
                        }
                    });
                }
            }, [isPlaying, employesCharges]);

            // Timer management
            useEffect(() => {
                if (jeuCommence && !jeuTermine) {
                    timerRef.current = setInterval(function() {
                        setTempsRestant(function(prev) {
                            if (prev <= 1) {
                                clearInterval(timerRef.current);
                                
                                // Store current stats before state updates
                                const currentScore = stats.score;
                                const currentDiscovered = stats.decouverts;
                                
                                setJeuTermine(true);
                                
                                // Reveal all answers when time is up
                                setEmployes(function(prevEmployes) {
                                    return prevEmployes.map(function(employe) {
                                        return { ...employe, decouvert: true };
                                    });
                                });
                                
                                // Save score with the current values
                                saveScore(currentScore, currentDiscovered);
                                
                                return 0;
                            }
                            return prev - 1;
                        });
                    }, 1000);
                }
                
                return function() {
                    if (timerRef.current) {
                        clearInterval(timerRef.current);
                    }
                };
            }, [jeuCommence, jeuTermine]);

            // Start playing (after entering email)
            function handleStartPlaying(e) {
                e.preventDefault();
                if (!playerEmail || !playerEmail.includes('@')) {
                    setLoginMessage("Please enter a valid email address");
                    setIsLoginError(true);
                    return;
                }
                
                setIsPlaying(true);
            }

            // Start game
            function commencerJeu() {
                setJeuCommence(true);
                setTempsRestant(1200); // 20 minutes
                setJeuTermine(false);
                
                // Reset discovered employees
                setEmployes(function(prevEmployes) {
                    return prevEmployes.map(function(employe) {
                        return { ...employe, decouvert: false };
                    });
                });
                
                setStats(function(prev) { 
                    return { ...prev, decouverts: 0, score: 0 };
                });
                
                setMessage("Game started! You have 20 minutes to find as many names as possible.");
                setIsError(false);
            }

            // Format remaining time
            function formaterTemps(secondes) {
                const minutes = Math.floor(secondes / 60);
                const secondesRestantes = secondes % 60;
                return `${minutes.toString().padStart(2, '0')}:${secondesRestantes.toString().padStart(2, '0')}`;
            }

            // Calculate Levenshtein distance (similarity between two strings)
            function levenshteinDistance(a, b) {
                const matrix = [];
                
                // Increment
                function increment(i, j) {
                    return matrix[i][j] + 1;
                }
                
                // Insert
                function insertion(i, j) {
                    return matrix[i][j - 1] + 1;
                }
                
                // Substitute
                function substitution(i, j) {
                    return matrix[i - 1][j - 1] + (a[i - 1] !== b[j - 1] ? 1 : 0);
                }
                
                // Initialize matrix
                for (let i = 0; i <= a.length; i++) {
                    matrix[i] = [i];
                }
                
                for (let j = 1; j <= b.length; j++) {
                    matrix[0][j] = j;
                }
                
                // Fill matrix
                for (let i = 1; i <= a.length; i++) {
                    for (let j = 1; j <= b.length; j++) {
                        matrix[i][j] = Math.min(
                            increment(i - 1, j),     // deletion
                            insertion(i, j),         // insertion
                            substitution(i, j)       // substitution
                        );
                    }
                }
                
                return matrix[a.length][b.length];
            }

            // Calculate similarity between two strings (between 0 and 1)
            function calculateSimilarity(str1, str2) {
                const maxLength = Math.max(str1.length, str2.length);
                if (maxLength === 0) return 1.0; // If both strings are empty, they're identical
                
                const distance = levenshteinDistance(str1, str2);
                return 1.0 - distance / maxLength;
            }

            // Find best match for a searched name
            function trouverMeilleurMatch(nomRecherche) {
                let meilleurMatch = null;
                let meilleureSimilarite = 0;
                
                employes.forEach(function(employe) {
                    if (!employe.decouvert) {
                        const similarite = calculateSimilarity(
                            nomRecherche.toLowerCase(),
                            employe.nom.toLowerCase()
                        );
                        
                        if (similarite > meilleureSimilarite && similarite >= seuilSimilarite) {
                            meilleureSimilarite = similarite;
                            meilleurMatch = employe;
                        }
                    }
                });
                
                return { employe: meilleurMatch, similarite: meilleureSimilarite };
            }

            // Handle search form submission
            function verifierNom(e) {
                e.preventDefault();
                
                // Save current scroll position
                scrollPositionRef.current = window.scrollY;
                
                if (!jeuCommence || jeuTermine) {
                    setMessage(jeuTermine ? "Time's up! All answers are revealed." : "Click 'Start' to begin the game.");
                    setIsError(true);
                    return;
                }
                
                if (!recherche.trim()) {
                    setMessage("Please enter a name");
                    setIsError(true);
                    return;
                }
                
                const nomRecherche = recherche.trim().toLowerCase();
                
                // Check if name is exactly the same
                const employeExact = employes.find(
                    function(e) { return e.nom.toLowerCase() === nomRecherche && !e.decouvert; }
                );
                
                // If no exact match, look for best match
                if (!employeExact) {
                    const { employe: meilleurMatch, similarite } = trouverMeilleurMatch(nomRecherche);
                    
                    if (meilleurMatch) {
                        // Find approximate match
                        let pointsGagnes = 10; // Default: 10 points without hints
                        
                        // Calculate points based on hints used
                        if (indicesActives.communaute && indicesActives.role && indicesActives.initiales) {
                            pointsGagnes = 1; // 1 point with all hints
                        } else if ((indicesActives.communaute && indicesActives.role) || 
                                (indicesActives.communaute && indicesActives.initiales) || 
                                (indicesActives.role && indicesActives.initiales)) {
                            pointsGagnes = 3; // 3 points with two hints
                        } else if (indicesActives.communaute || indicesActives.role || indicesActives.initiales) {
                            pointsGagnes = 5; // 5 points with one hint
                        }
                        
                        // Slightly reduce points for approximate matches
                        pointsGagnes = Math.round(pointsGagnes * similarite);
                        
                        setStats(function(prev) { 
                            return { 
                                ...prev, 
                                decouverts: prev.decouverts + 1,
                                score: prev.score + pointsGagnes
                            };
                        });
                        
                        // Update employee as discovered
                        setEmployes(function(prev) {
                            return prev.map(function(e) {
                                return e.id === meilleurMatch.id ? { ...e, decouvert: true } : e;
                            });
                        });
                        
                        setMessage(`Well done! You found an employee with a similar name: "${meilleurMatch.prenom} ${meilleurMatch.nom}" (${Math.round(similarite * 100)}% similarity). +${pointsGagnes} points!`);
                        setIsError(false);
                        setRecherche("");
                        
                        // Restore scroll position after rendering
                        setTimeout(function() {
                            window.scrollTo(0, scrollPositionRef.current);
                        }, 0);
                        
                        return;
                    }
                    
                    // Check if employee has already been discovered
                    const employeDejaDecouvert = employes.find(
                        function(e) { return e.nom.toLowerCase() === nomRecherche && e.decouvert; }
                    );
                    
                    if (employeDejaDecouvert) {
                        setMessage(`You've already found ${employeDejaDecouvert.prenom} ${employeDejaDecouvert.nom}.`);
                        setIsError(true);
                    } else {
                        setMessage(`No employee found with the name "${recherche}".`);
                        setIsError(true);
                    }
                    
                    setRecherche("");
                    
                    // Restore scroll position after rendering
                    setTimeout(function() {
                        window.scrollTo(0, scrollPositionRef.current);
                    }, 0);
                    
                    return;
                }
                
                // Exact match found
                let pointsGagnes = 10; // Default: 10 points without hints
                
                // Calculate points based on hints used
                if (indicesActives.communaute && indicesActives.role && indicesActives.initiales) {
                    pointsGagnes = 1; // 1 point with all hints
                } else if ((indicesActives.communaute && indicesActives.role) || 
                        (indicesActives.communaute && indicesActives.initiales) || 
                        (indicesActives.role && indicesActives.initiales)) {
                    pointsGagnes = 3; // 3 points with two hints
                } else if (indicesActives.communaute || indicesActives.role || indicesActives.initiales) {
                    pointsGagnes = 5; // 5 points with one hint
                }
                
                setStats(function(prev) { 
                    return { 
                        ...prev, 
                        decouverts: prev.decouverts + 1,
                        score: prev.score + pointsGagnes
                    };
                });
                
                // Update employee as discovered
                setEmployes(function(prev) {
                    return prev.map(function(e) {
                        return e.id === employeExact.id ? { ...e, decouvert: true } : e;
                    });
                });
                
                setMessage(`Well done! You found ${employeExact.prenom} ${employeExact.nom}. +${pointsGagnes} points!`);
                setIsError(false);
                setRecherche("");
                
                // Restore scroll position after rendering
                setTimeout(function() {
                    window.scrollTo(0, scrollPositionRef.current);
                }, 0);
            }

            // Toggle hints
            function toggleIndice(indice) {
                if (!jeuCommence || jeuTermine) return;
                
                setIndicesActives(function(prev) {
                    const newState = { ...prev };
                    newState[indice] = !prev[indice];
                    return newState;
                });
            }

            // Change similarity threshold
            function changerSeuilSimilarite(e) {
                setSeuilSimilarite(parseFloat(e.target.value));
            }

            // Login screen display
            if (!isPlaying) {
                return React.createElement(
                    "div",
                    null,
                    [
                        // Main title
                        React.createElement(
                            "h1",
                            { style: { textAlign: "center", marginBottom: "30px" } },
                            "First 100 Alaners"
                        ),
                        
                        // Login form
                        React.createElement(
                            "div",
                            { className: "login-container" },
                            [
                                React.createElement("h2", null, "Enter your email to play"),
                                
                                React.createElement(
                                    "form",
                                    { onSubmit: handleStartPlaying },
                                    [
                                        React.createElement(
                                            "div",
                                            { style: { marginBottom: "15px" } },
                                            [
                                                React.createElement("label", { htmlFor: "email" }, "Your email:"),
                                                React.createElement("input", {
                                                    id: "email",
                                                    type: "email",
                                                    value: playerEmail,
                                                    onChange: (e) => setPlayerEmail(e.target.value),
                                                    placeholder: "example@alan.eu",
                                                    required: true
                                                })
                                            ]
                                        ),
                                        
                                        loginMessage && React.createElement(
                                            "div",
                                            { 
                                                className: isLoginError ? "error" : "success",
                                                style: { marginBottom: "15px" }
                                            },
                                            loginMessage
                                        ),
                                        
                                        React.createElement(
                                            "button",
                                            { 
                                                type: "submit",
                                                className: "start-button"
                                            },
                                            "Start Playing"
                                        )
                                    ]
                                )
                            ]
                        ),
                        
                        // Leaderboard
                        React.createElement(
                            "div",
                            { className: "container", style: { marginTop: "30px" } },
                            [
                                React.createElement(
                                    "h2",
                                    { style: { display: "flex", justifyContent: "space-between", alignItems: "center" } },
                                    [
                                        "Leaderboard",
                                        React.createElement(
                                            "button",
                                            { 
                                                onClick: loadLeaderboard,
                                                style: { fontSize: "14px", padding: "5px 10px" }
                                            },
                                            "Refresh"
                                        )
                                    ]
                                ),
                                
                                isLoadingLeaderboard 
                                    ? React.createElement("p", null, "Loading leaderboard...")
                                    : React.createElement(
                                        "table",
                                        { className: "leaderboard-table" },
                                        [
                                            React.createElement(
                                                "thead",
                                                null,
                                                React.createElement(
                                                    "tr",
                                                    null,
                                                    [
                                                        React.createElement("th", null, "Rank"),
                                                        React.createElement("th", null, "Player"),
                                                        React.createElement("th", { style: { textAlign: "right" } }, "Score"),
                                                        React.createElement("th", { style: { textAlign: "right" } }, "Found")
                                                    ]
                                                )
                                            ),
                                            
                                            React.createElement(
                                                "tbody",
                                                null,
                                                leaderboard.length > 0 
                                                    ? leaderboard.map((entry, index) => 
                                                        React.createElement(
                                                            "tr",
                                                            { 
                                                                key: entry.id,
                                                                className: entry.email === playerEmail ? "highlight-row" : ""
                                                            },
                                                            [
                                                                React.createElement("td", null, `#${index + 1}`),
                                                                React.createElement("td", null, entry.email ? entry.email.split('@')[0] : "Anonymous"),
                                                                React.createElement("td", { style: { textAlign: "right", fontWeight: "bold" } }, entry.score),
                                                                React.createElement("td", { style: { textAlign: "right" } }, `${entry.discovered || 0}/${entry.total || 100}`)
                                                            ]
                                                        )
                                                    )
                                                    : React.createElement(
                                                        "tr",
                                                        null,
                                                        React.createElement(
                                                            "td",
                                                            { colSpan: 4, style: { textAlign: "center", padding: "15px" } },
                                                            "No scores recorded yet"
                                                        )
                                                    )
                                            )
                                        ]
                                    )
                            ]
                        )
                    ]
                );
            }

            // Loading message if data isn't loaded yet
            if (!employesCharges) {
                return React.createElement(
                    "div", 
                    { className: "container" },
                    React.createElement(
                        "div", 
                        { style: { textAlign: "center", padding: "50px" } },
                        "Loading data..."
                    )
                );
            }

            // Main game interface
            return React.createElement(
                "div",
                { className: "container" },
                [
                    // Title
                    React.createElement(
                        "h1",
                        { style: { textAlign: "center", marginBottom: "20px" } },
                        "First 100 Alaners"
                    ),
                    
                    // Instructions
                    React.createElement(
                        "div",
                        { style: { backgroundColor: "#f0f9ff", padding: "15px", borderRadius: "8px", marginBottom: "20px" } },
                        [
                            React.createElement(
                                "h2",
                                { style: { fontSize: "1.25rem", marginBottom: "10px" } },
                                "How to play:"
                            ),
                            React.createElement(
                                "ol",
                                { style: { paddingLeft: "20px" } },
                                [
                                    React.createElement("li", null, "Guess the last name of one of the first 100 Alan employees"),
                                    React.createElement("li", null, [
                                        React.createElement("strong", null, "10 points"),
                                        " per name found without hints"
                                    ]),
                                    React.createElement("li", null, [
                                        "Use hint buttons to help you:",
                                        React.createElement(
                                            "ul",
                                            { style: { paddingLeft: "20px", marginTop: "5px" } },
                                            [
                                                React.createElement("li", null, [
                                                    "With 1 hint: ",
                                                    React.createElement("strong", null, "5 points"),
                                                    " per name found"
                                                ]),
                                                React.createElement("li", null, [
                                                    "With 2 hints: ",
                                                    React.createElement("strong", null, "3 points"),
                                                    " per name found"
                                                ]),
                                                React.createElement("li", null, [
                                                    "With 3 hints: ",
                                                    React.createElement("strong", null, "1 point"),
                                                    " per name found"
                                                ])
                                            ]
                                        )
                                    ]),
                                    React.createElement("li", null, "Approximate spellings are accepted"),
                                    React.createElement("li", null, [
                                        "You have ",
                                        React.createElement("strong", null, "20 minutes"),
                                        " to find as many names as possible!"
                                    ])
                                ]
                            ),
                            
                            !jeuCommence && !jeuTermine ? React.createElement(
                                "div",
                                { style: { textAlign: "center", marginTop: "15px" } },
                                React.createElement(
                                    "button",
                                    { onClick: commencerJeu },
                                    "Start"
                                )
                            ) : null
                        ]
                    ),
                    
                    // Timer
                    React.createElement(
                        "div",
                        { 
                            className: `timer ${tempsRestant < 300 ? "ending" : ""}`,
                        },
                        [
                            React.createElement(
                                "div",
                                null,
                                formaterTemps(tempsRestant)
                            ),
                            
                            jeuCommence ? React.createElement(
                                "div",
                                { style: { fontSize: "14px" } },
                                jeuTermine ? "Time's up!" : "Time remaining"
                            ) : null
                        ]
                    ),
                    
                    // Search form
                    React.createElement(
                        "div",
                        { className: "sticky-search" },
                        [
                            React.createElement(
                                "form",
                                { onSubmit: verifierNom },
                                [
                                    React.createElement(
                                        "div",
                                        { style: { display: "flex", gap: "10px" } },
                                        [
                                            React.createElement(
                                                "input",
                                                {
                                                    type: "text",
                                                    value: recherche,
                                                    onChange: (e) => setRecherche(e.target.value),
                                                    placeholder: "Enter a last name...",
                                                    disabled: !jeuCommence || jeuTermine,
                                                    style: { 
                                                        flex: "1",
                                                        opacity: (!jeuCommence || jeuTermine) ? 0.7 : 1
                                                    }
                                                }
                                            ),
                                            React.createElement(
                                                "button",
                                                {
                                                    type: "submit",
                                                    disabled: !jeuCommence || jeuTermine,
                                                    style: {
                                                        opacity: (!jeuCommence || jeuTermine) ? 0.7 : 1
                                                    }
                                                },
                                                "Check"
                                            )
                                        ]
                                    )
                                ]
                            ),
                            
                            // Message
                            message && React.createElement(
                                "div",
                                { className: `message ${isError ? "error" : "success"}` },
                                message
                            )
                        ]
                    ),
                    
                    // Statistics and controls
                    React.createElement(
                        "div",
                        {
                            style: {
                                backgroundColor: "#f9fafb",
                                padding: "15px",
                                borderRadius: "8px",
                                marginBottom: "20px",
                                display: "flex",
                                flexDirection: "column",
                                gap: "15px"
                            }
                        },
                        [
                            // Statistics
                            React.createElement(
                                "div",
                                null,
                                [
                                    React.createElement(
                                        "div",
                                        null,
                                        `Progress: ${stats.decouverts} / ${stats.total} employees found`
                                    ),
                                    React.createElement(
                                        "div",
                                        { style: { fontSize: "18px", fontWeight: "bold" } },
                                        `Score: ${stats.score} points`
                                    ),
                                    React.createElement(
                                        "div",
                                        null,
                                        `Player: ${playerEmail.split('@')[0]}`
                                    )
                                ]
                            ),
                            
                            // Hint buttons
                            React.createElement(
                                "div",
                                { style: { display: "flex", flexWrap: "wrap", gap: "10px" } },
                                [
                                    // Hint: Community
                                    React.createElement(
                                        "button",
                                        {
                                            onClick: () => toggleIndice('communaute'),
                                            disabled: !jeuCommence || jeuTermine,
                                            className: indicesActives.communaute ? "hint-button active" : "hint-button",
                                            style: {
                                                opacity: (!jeuCommence || jeuTermine) ? 0.7 : 1
                                            }
                                        },
                                        indicesActives.communaute ? 'Hide community' : 'Hint: Community'
                                    ),
                                    
                                    // Hint: Role
                                    React.createElement(
                                        "button",
                                        {
                                            onClick: () => toggleIndice('role'),
                                            disabled: !jeuCommence || jeuTermine,
                                            className: indicesActives.role ? "hint-button active" : "hint-button",
                                            style: {
                                                opacity: (!jeuCommence || jeuTermine) ? 0.7 : 1
                                            }
                                        },
                                        indicesActives.role ? 'Hide role' : 'Hint: Role'
                                    ),
                                    
                                    // Hint: Initials
                                    React.createElement(
                                        "button",
                                        {
                                            onClick: () => toggleIndice('initiales'),
                                            disabled: !jeuCommence || jeuTermine,
                                            className: indicesActives.initiales ? "hint-button active" : "hint-button",
                                            style: {
                                                opacity: (!jeuCommence || jeuTermine) ? 0.7 : 1
                                            }
                                        },
                                        indicesActives.initiales ? 'Hide initials' : 'Hint: Initials'
                                    )
                                ]
                            ),
                            
                            // Action buttons
                            React.createElement(
                                "div",
                                { className: "actions-container" },
                                [
                                    // Finish button (only visible during active game)
                                    jeuCommence && !jeuTermine && React.createElement(
                                        "button",
                                        {
                                            onClick: finishGame,
                                            className: "finish-button"
                                        },
                                        "Finish"
                                    )
                                    
                                    // "Change Email" button removed as requested
                                ]
                            )
                        ]
                    ),
                    
                    // Similarity threshold setting
                    React.createElement(
                        "div",
                        {
                            style: {
                                backgroundColor: "#f0f9ff",
                                padding: "15px",
                                borderRadius: "8px",
                                marginBottom: "20px"
                            }
                        },
                        [
                            React.createElement(
                                "div",
                                { style: { fontWeight: "500", marginBottom: "10px" } },
                                `Matching sensitivity: ${Math.round(seuilSimilarite * 100)}%`
                            ),
                            React.createElement(
                                "input",
                                {
                                    type: "range",
                                    min: "0.5",
                                    max: "0.95",
                                    step: "0.05",
                                    value: seuilSimilarite,
                                    onChange: changerSeuilSimilarite,
                                    className: "sensitivity-slider"
                                }
                            ),
                            React.createElement(
                                "div",
                                { style: { display: "flex", justifyContent: "space-between", fontSize: "14px", color: "#6b7280" } },
                                [
                                    React.createElement("span", null, "More flexible"),
                                    React.createElement("span", null, "More strict")
                                ]
                            )
                        ]
                    ),
                    
                    // Employee list
                    React.createElement(
                        "div",
                        { className: "employee-list" },
                        [
                            // Title
                            React.createElement(
                                "div",
                                { className: "employee-list-header" },
                                `Employee List (${employes.length})`
                            ),
                            
                            // Employee table
                            React.createElement(
                                "table",
                                { className: "employee-table" },
                                [
                                    // Table header
                                    React.createElement(
                                        "thead",
                                        null,
                                        React.createElement(
                                            "tr",
                                            null,
                                            [
                                                React.createElement("th", null, "ID"),
                                                React.createElement("th", null, "Start Date"),
                                                indicesActives.communaute && React.createElement("th", null, "Community"),
                                                indicesActives.role && React.createElement("th", null, "Role"),
                                                indicesActives.initiales && React.createElement("th", null, "Initials"),
                                                React.createElement("th", null, "Full Name")
                                            ].filter(Boolean) // Filter out null elements
                                        )
                                    ),
                                    
                                    // Table body
                                    React.createElement(
                                        "tbody",
                                        null,
                                        employes.map(function(employe, idx) {
                                            return React.createElement(
                                                "tr",
                                                { key: employe.id },
                                                [
                                                    React.createElement("td", null, employe.id),
                                                    React.createElement("td", null, employe.dateDebut),
                                                    indicesActives.communaute && React.createElement("td", null, employe.communaute),
                                                    indicesActives.role && React.createElement("td", null, employe.role),
                                                    indicesActives.initiales && React.createElement(
                                                        "td",
                                                        null,
                                                        `${employe.initialePrenom}. ${employe.initialeNom}.`
                                                    ),
                                                    React.createElement(
                                                        "td",
                                                        null,
                                                        employe.decouvert 
                                                            ? React.createElement("span", { style: { fontWeight: "500" } }, `${employe.prenom} ${employe.nom}`)
                                                            : React.createElement("span", { className: "hidden-name" }, "● ●")
                                                    )
                                                ].filter(Boolean) // Filter out null elements
                                            );
                                        })
                                    )
                                ]
                            )
                        ]
                    ),
                    
                    // Game over message
                    jeuTermine && React.createElement(
                        "div",
                        { 
                            style: { 
                                backgroundColor: "#fee2e2", 
                                padding: "20px", 
                                borderRadius: "8px", 
                                textAlign: "center", 
                                marginTop: "20px" 
                            } 
                        },
                        [
                            React.createElement("h2", { style: { color: "#b91c1c" } }, "Time's up!"),
                            React.createElement(
                                "p",
                                null,
                                [
                                    "You found ",
                                    React.createElement("strong", null, stats.decouverts),
                                    ` employees out of ${stats.total} and scored `,
                                    React.createElement("strong", null, stats.score),
                                    " points."
                                ]
                            ),
                            React.createElement(
                                "p",
                                { style: { fontStyle: "italic", margin: "10px 0" } },
                                "Your score is being saved. You'll be redirected to the leaderboard shortly..."
                            ),
                            
                            // Play again button
                            React.createElement(
                                "div",
                                { className: "actions-container" },
                                [
                                    React.createElement(
                                        "button",
                                        { 
                                            onClick: () => {
                                                if (timerRef.current) {
                                                    clearInterval(timerRef.current);
                                                }
                                                
                                                setEmployes(employes.map(function(e) { return { ...e, decouvert: false }; }));
                                                setStats({ total: employes.length, decouverts: 0, score: 0 });
                                                setIndicesActives({ communaute: false, role: false, initiales: false });
                                                setJeuCommence(false);
                                                setJeuTermine(false);
                                                setTempsRestant(1200);
                                                setMessage("Game reset! Click 'Start' to begin a new game.");
                                                setIsError(false);
                                            },
                                            style: {
                                                backgroundColor: "#3b82f6"
                                            }
                                        },
                                        "Play Again"
                                    )
                                ]
                            )
                        ]
                    )
                ]
            );
        }

        // Render the application
        ReactDOM.render(React.createElement(App), document.getElementById('root'));
    </script>
</body>
</html>
